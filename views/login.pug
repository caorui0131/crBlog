extends layout

block css
    style(type="text/css").
        .logindiv{
            height: 400px;
            width: 350px;
            background:#ffffff;
            position: absolute;
            left: 50%;
            top: 50%;
            margin:-250px 0 0 -150px;
            z-index: 2;
        }
        .dl{
            text-align: center;
            top: 20px;
            position: absolute;
            left: 46%;
        }
        .ipt{
            position: absolute;
            top:20%;
            left: 10%;
            width: 300px;
        }
        .ipt .password,.ipt .username{
            line-height: 100%;
            background-color: #fff!important;
            content: "'fill'";
            display: block;
            width: 95%;
            height: 20px;
            border-radius: 4px 4px;
            line-height: 32px;
            font-size: 14px;
            color: #4d4d4d;
            border: 1px solid #ccc;
            margin-bottom:10px;
            padding: 8px 0px 8px 12px;
        }
        .loginbtn{
            line-height: 100%;
            background-color: #0084ff!important;
            content: "'fill'";
            display: block;
            width: 100%;
            height: 38px;
            border-radius: 4px 4px;
            line-height: 32px;
            font-size: 14px;
            color: #fff;
            margin-bottom:10px;
            margin-top:40px;
            border:none;
            padding: 0px 12px;
        }
        .loginusername,.password,.loginbtn{
            float:left;
        }
        #backurl{
            display:none
        }
block content
    //- 登录
    div.logindiv.div-box
        p.dl.title 登录
        div.ipt
            input.username(type="text" placeholder="用户名")
            input.password(type="password" placeholder="密码")
            input.loginbtn(type="submit" value="登录")
        #backurl #{backurl}
block script
    script.
        $(document).ready(function(){
            login();
            var  backurl= $('#backurl').text();
            if(!backurl||backurl==''){
                backurl='/'
            }
            function login(){
                $(".loginbtn").click(function(){
                    var username=$(".username").val();
                    var password=$(".password").val();
                    data={username,password,backurl};
                    $.post('/login',data,function(data){
                        if(data.code==200){
                            alert(data.successText);
                            //- location.reload();
                            window.location.href=data.backurl;
                        }else{
                            alert(data.errMsg);
                        }
                    })
                })
            }
        })
